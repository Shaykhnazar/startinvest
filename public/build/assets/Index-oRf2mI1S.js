/* empty css             */import{b as Q,E as X,a as ee}from"./el-main-B7V3latj.js";import{u as te,a as ae,P as ie,_ as j,I as oe,E as se,b as ne}from"./useInfiniteScroll-Dukb50Wc.js";import{A as le}from"./App-Mk9DyfZ6.js";import{a6 as re,m as H,q as B,o as u,f as q,b as o,n as de,a as d,w,u as a,F as O,Z as ue,p as me,c as k,g as S}from"./app-BVEWpKNB.js";import{u as ce,V as U}from"./UserStore-B5SiQ4Uz.js";import{u as fe}from"./helpers--8ZkwWuN.js";import{a as y}from"./api-CkdGCLvF.js";import"./plugin-vue_export-helper-CO5Aj5ce.js";import"./index-BH76j2uT.js";import"./use-global-config-Bv912UFb.js";import"./event-Ccp5Doe-.js";import"./el-popper-Boyvy_Wh.js";import"./el-button-B_ZlppaL.js";import"./TextEditor-BTnlsons.js";/* empty css                   */import"./el-col-HMeSGw8N.js";import"./el-avatar-BGPopQ45.js";import"./ApplicationLogo-LD5TGzw3.js";const pe={class:"hs-overlay-open:mt-7 hs-overlay-open:opacity-100 hs-overlay-open:duration-500 mt-0 opacity-0 ease-out transition-all sm:max-w-md sm:w-full m-3 sm:mx-auto h-[calc(100%-3.5rem)] min-h-[calc(100%-3.5rem)] flex items-center"},be={class:"relative w-full max-h-full overflow-hidden flex flex-col bg-white rounded-xl pointer-events-auto shadow-[0_10px_40px_10px_rgba(0,0,0,0.08)] dark:shadow-[0_10px_40px_10px_rgba(0,0,0,0.2)] dark:bg-neutral-800"},he={class:"absolute top-2 end-4 z-10"},ve=o("span",{class:"sr-only"},"Close",-1),ye=o("svg",{class:"shrink-0 size-4",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[o("path",{d:"M18 6 6 18"}),o("path",{d:"m6 6 12 12"})],-1),ge=[ve,ye],_e={class:"p-4"},xe=o("h3",{id:"hs-pro-dtlam-label",class:"text-lg font-medium text-gray-800 dark:text-neutral-200"}," Ishonchingiz komilmi? ",-1),we=o("p",{class:"mt-1 text-gray-500 dark:text-neutral-500"}," Haqiqatan ham bu go'yani oÊ»chirib tashlamoqchimisiz? ",-1),ke={class:"mt-4 flex justify-end gap-x-3"},Ie={__name:"IdeaDeleteModal",props:{idea:{type:[Object,null],required:!0},isVisible:{type:Boolean,default:!0}},emits:["close","deleteIdeaHandler"],setup(z,{emit:I}){const m=z,c=re(m.idea||{}),_=H(!0);return B(()=>m.idea,l=>{l?Object.assign(c,l):Object.keys(c).forEach(s=>delete c[s])},{immediate:!0}),B(()=>m.isVisible,l=>{_.value=l},{immediate:!0}),(l,s)=>(u(),q("div",{id:"hs-pro-dtlam",class:de({hidden:_.value,"hs-overlay size-full fixed top-0 start-0 z-[80] overflow-x-hidden overflow-y-auto [--close-when-click-inside:true] pointer-events-none":!0}),role:"dialog",tabindex:"-1","aria-labelledby":"hs-pro-dtlam-label"},[o("div",pe,[o("div",be,[o("div",he,[o("button",{type:"button",onClick:s[0]||(s[0]=f=>l.$emit("close")),class:"size-6 inline-flex justify-center items-center gap-x-2 rounded-full border border-transparent bg-gray-100 text-gray-800 hover:bg-gray-200 focus:outline-none focus:bg-gray-200 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-700 dark:hover:bg-neutral-600 dark:text-neutral-400 dark:focus:bg-neutral-600","aria-label":"Close","data-hs-overlay":"#hs-pro-dtlam"},ge)]),o("div",_e,[xe,we,o("div",ke,[o("button",{type:"button",onClick:s[1]||(s[1]=f=>l.$emit("close")),class:"py-2 px-3 inline-flex items-center gap-x-2 text-xs font-medium rounded-lg border border-gray-200 bg-white text-gray-800 shadow-sm hover:bg-gray-50 disabled:opacity-50 disabled:pointer-events-none focus:outline-none focus:bg-gray-50 dark:bg-neutral-800 dark:border-neutral-700 dark:text-neutral-300 dark:hover:bg-neutral-700 dark:focus:bg-neutral-700","data-hs-overlay":"#hs-pro-dtlam"}," Bekor qilish "),o("button",{type:"button",onClick:s[2]||(s[2]=f=>l.$emit("deleteIdeaHandler",c.id)),class:"py-2 px-3 inline-flex items-center gap-x-2 text-xs font-medium rounded-lg border border-transparent bg-red-500 text-white hover:bg-red-600 disabled:opacity-50 disabled:pointer-events-none"}," Ha, ishonchim komil ")])])])])],2))}},Re={__name:"Index",props:{ideas:{type:Object}},setup(z){const I=H(null),{ideaForm:m,ideaCommentForm:c,ideaDeleteModalProps:_,resetForm:l,showIdeaModal:s,showIdeaEditModal:f,showIdeaCommentModal:E,showIdeaDeleteModal:M,ideaModalVisible:F,ideaEditModalVisible:P,ideaCommentModalVisible:N,ideaDeleteModalVisible:A}=te(),{info:p,success:C}=fe(),{items:g}=ae("ideas",I),r=ce(),i=H(!1),b=(e,t=!1)=>{const n=g.value.findIndex(h=>h.id===e.id);n!==-1&&!t?g.value[n]=e:t?g.value.splice(n,1):g.value.unshift(e)},V=async(e,t)=>{e&&await e.validate((n,h)=>{n&&(i.value=!0,t.id!==null?D(t):R(t))})},D=async e=>{await y.ideas.edit(e.id,{title:e.title,description:e.description}).then(t=>{b(t.data.idea),f(!1),C("G'oya muvaffaqiyatli tahrirlandi")}).finally(()=>{i.value=!1})},R=async e=>{await y.ideas.add({title:e.title,description:e.description}).then(t=>{b(t.data.idea),s(!1),C("G'oya muvaffaqiyatli qo'shildi")}).finally(()=>{i.value=!1})},Y=async e=>{i.value=!0,await y.ideas.delete(e).then(t=>{b(t.data.idea,!0),M(!1),p("G'oya muvaffaqiyatli o'chirildi")}).finally(()=>{i.value=!1})};async function L(e){$()&&!r.hasUpvotedIdea(e)&&!i.value&&await G(e,U.UP)}async function T(e){$()&&!r.hasDownvotedIdea(e)&&!i.value&&await G(e,U.DOWN)}async function W(e){r.isGuest?p("G'oyalarni saqlash uchun tizimga kiring"):i.value||(i.value=!0,await y.ideas.favorite(e.id).then(t=>{b(t.data.idea),r.updateUserFavorites(t.data.user_favorites),r.hasFavoritedIdea(e)?C("G'oya muvaffaqiyatli saqlandi"):p("G'oya sizning sevimlilar ro'yxatingizdan o'chirildi")}).finally(()=>{i.value=!1}))}async function Z(e,t){if(r.isGuest)p("Iltimos, sharh qoldirish uchun tizimga kiring");else if(!i.value){if(!e)return;await e.validate(async(n,h)=>{n&&(i.value=!0,await y.ideas.comment(t.idea.id,{body:t.body,parent_id:t.parent_id??null}).then(x=>{b(x.data.idea),r.updateUserComments(x.data.user_comments)}).finally(()=>{i.value=!1}))})}}function J(e){}function $(){return r.isGuest?(p("Ovoz berish uchun tizimga kiring"),!1):!0}async function G(e,t){i.value=!0,await y.ideas.vote(e.id,{type:t}).then(n=>{b(n.data.idea),r.updateUserVotes(n.data.user_votes),p("Ovoz berildi")}).finally(()=>{i.value=!1})}return(e,t)=>{const n=se,h=Q,x=X,K=ee;return u(),q(O,null,[d(le,null,{header:w(()=>[d(a(ue),{title:"G'oyalar"})]),default:w(()=>[d(n,{right:50,bottom:50,"visibility-height":300}),d(K,{class:"justify-center"},{default:w(()=>[d(h,{class:"hidden md:block"}),d(x,{class:"max-w-[50rem]"},{default:w(()=>[d(ie,{onShowModal:a(s)},null,8,["onShowModal"]),(u(!0),q(O,null,me(a(g),v=>(u(),k(ne,{key:v.id,idea:v,submitting:i.value,onShowEditModalHandler:a(f),onShowCommentModalHandler:a(E),onShowDeleteModalHandler:a(M),onVoteUpHandler:L,onVoteDownHandler:T,onFavoriteIdeaHandler:W,onSendIdeaHandler:J,class:"mb-2"},null,8,["idea","submitting","onShowEditModalHandler","onShowCommentModalHandler","onShowDeleteModalHandler"]))),128)),o("div",{ref_key:"landmark",ref:I},null,512)]),_:1}),d(h,{class:"hidden lg:block"})]),_:1}),a(F)?(u(),k(j,{key:0,"idea-form":a(m),submitting:i.value,title:"Yangi g'oya","submit-button-text":"Yuborish",onClose:t[0]||(t[0]=v=>a(s)(!1)),onSubmit:V,onReset:a(l)},null,8,["idea-form","submitting","onReset"])):S("",!0),a(P)?(u(),k(j,{key:1,"idea-form":a(m),submitting:i.value,title:"G'oyani tahrirlash","submit-button-text":"Saqlash",onClose:t[1]||(t[1]=v=>a(f)(!1)),onSubmit:V,onReset:a(l)},null,8,["idea-form","submitting","onReset"])):S("",!0),a(N)?(u(),k(oe,{key:2,"idea-comment-form":a(c),submitting:i.value,"submit-button-text":"Yuborish",onClose:t[2]||(t[2]=v=>a(E)(!1)),onSubmit:Z},null,8,["idea-comment-form","submitting"])):S("",!0)]),_:1}),d(Ie,{"is-visible":a(A),idea:a(_).idea,onClose:t[3]||(t[3]=v=>a(M)(!1)),onDeleteIdeaHandler:Y},null,8,["is-visible","idea"])],64)}}};export{Re as default};
